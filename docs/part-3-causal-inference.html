<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Part 3: Causal Inference | GT</title>
  <meta name="description" content="5 Part 3: Causal Inference | GT" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Part 3: Causal Inference | GT" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Part 3: Causal Inference | GT" />
  
  
  

<meta name="author" content="Katherine Wilson and Jess Huang" />


<meta name="date" content="2022-02-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-2-descriptive-analysis.html"/>
<link rel="next" href="part-3-geospatial-analysis.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Gifted and Talented</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="motivation.html"><a href="motivation.html"><i class="fa fa-check"></i><b>2</b> Motivation</a></li>
<li class="chapter" data-level="3" data-path="part-1-assumptionsnotations.html"><a href="part-1-assumptionsnotations.html"><i class="fa fa-check"></i><b>3</b> Part 1: Assumptions/Notations</a>
<ul>
<li class="chapter" data-level="3.0.1" data-path="part-1-assumptionsnotations.html"><a href="part-1-assumptionsnotations.html#review-of-causal-rules-for-ignorabilitycovariate-selection"><i class="fa fa-check"></i><b>3.0.1</b> Review of Causal rules for ignorability/covariate selection</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html"><i class="fa fa-check"></i><b>4</b> Part 2: Descriptive Analysis</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html#data-cleaning"><i class="fa fa-check"></i><b>4.0.1</b> Data cleaning</a></li>
<li class="chapter" data-level="4.0.2" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html#visualizing-the-treatment-gt-option"><i class="fa fa-check"></i><b>4.0.2</b> Visualizing the Treatment (GT option)</a></li>
<li class="chapter" data-level="4.0.3" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html#raw-differences-in-outcome-and-covariates"><i class="fa fa-check"></i><b>4.0.3</b> Raw Differences in Outcome and Covariates</a></li>
<li class="chapter" data-level="4.0.4" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html#correlation-of-covariates"><i class="fa fa-check"></i><b>4.0.4</b> Correlation of covariates</a></li>
<li class="chapter" data-level="4.0.5" data-path="part-2-descriptive-analysis.html"><a href="part-2-descriptive-analysis.html#naive-regression-models-without-matching"><i class="fa fa-check"></i><b>4.0.5</b> Naive regression models (without matching)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="part-3-causal-inference.html"><a href="part-3-causal-inference.html"><i class="fa fa-check"></i><b>5</b> Part 3: Causal Inference</a></li>
<li class="chapter" data-level="6" data-path="part-3-geospatial-analysis.html"><a href="part-3-geospatial-analysis.html"><i class="fa fa-check"></i><b>6</b> Part 3: GeoSpatial Analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">GT</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part-3-causal-inference" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Part 3: Causal Inference</h1>
<p>Given that the groups are imbalanced (GT option schools are more likely to be high income, less SWD, more students), can we balance the groups to get the ATE of the GT option on ELA and MATH scores?</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="part-3-causal-inference.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MatchIt)</span>
<span id="cb1-2"><a href="part-3-causal-inference.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cobalt)</span>
<span id="cb1-3"><a href="part-3-causal-inference.html#cb1-3" aria-hidden="true" tabindex="-1"></a>school_nearest <span class="ot">&lt;-</span> <span class="fu">matchit</span>(<span class="at">formula =</span> treatment <span class="sc">~</span> ENI <span class="sc">+</span> PercentBlack <span class="sc">+</span></span>
<span id="cb1-4"><a href="part-3-causal-inference.html#cb1-4" aria-hidden="true" tabindex="-1"></a>                            TotalEnrollment <span class="sc">+</span> PercentSWD, </span>
<span id="cb1-5"><a href="part-3-causal-inference.html#cb1-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">data =</span> small,</span>
<span id="cb1-6"><a href="part-3-causal-inference.html#cb1-6" aria-hidden="true" tabindex="-1"></a>                          <span class="at">method =</span> <span class="st">&quot;nearest&quot;</span>,</span>
<span id="cb1-7"><a href="part-3-causal-inference.html#cb1-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">family =</span> <span class="st">&quot;binomial&quot;</span>,</span>
<span id="cb1-8"><a href="part-3-causal-inference.html#cb1-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">caliper =</span> <span class="fl">0.25</span>,</span>
<span id="cb1-9"><a href="part-3-causal-inference.html#cb1-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">ratio =</span> <span class="dv">6</span>)</span>
<span id="cb1-10"><a href="part-3-causal-inference.html#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="part-3-causal-inference.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## balance improvement</span></span>
<span id="cb1-12"><a href="part-3-causal-inference.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.tab</span>(school_nearest, <span class="at">m.threshold =</span> <span class="fl">0.1</span>)</span></code></pre></div>
<pre><code>## Call
##  matchit(formula = treatment ~ ENI + PercentBlack + TotalEnrollment + 
##     PercentSWD, data = small, method = &quot;nearest&quot;, caliper = 0.25, 
##     ratio = 6, family = &quot;binomial&quot;)
## 
## Balance Measures
##                     Type Diff.Adj    M.Threshold
## distance        Distance   0.0164 Balanced, &lt;0.1
## ENI              Contin.   0.0030 Balanced, &lt;0.1
## PercentBlack     Contin.  -0.0174 Balanced, &lt;0.1
## TotalEnrollment  Contin.  -0.0127 Balanced, &lt;0.1
## PercentSWD       Contin.  -0.0240 Balanced, &lt;0.1
## 
## Balance tally for mean differences
##                    count
## Balanced, &lt;0.1         5
## Not Balanced, &gt;0.1     0
## 
## Variable with the greatest mean difference
##    Variable Diff.Adj    M.Threshold
##  PercentSWD   -0.024 Balanced, &lt;0.1
## 
## Sample sizes
##                      Control Treated
## All                   1009.      101
## Matched (ESS)          366.8      98
## Matched (Unweighted)   459.       98
## Unmatched              550.        3</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="part-3-causal-inference.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.plot</span>(school_nearest, <span class="at">var.name =</span> <span class="st">&#39;TotalEnrollment&#39;</span>, <span class="at">which =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="part-3-causal-inference.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.plot</span>(school_nearest, <span class="at">var.name =</span> <span class="st">&#39;PercentBlack&#39;</span>, <span class="at">which =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-2.png" width="672" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="part-3-causal-inference.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.plot</span>(school_nearest, <span class="at">var.name =</span> <span class="st">&#39;PercentSWD&#39;</span>, <span class="at">which =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-3.png" width="672" /></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="part-3-causal-inference.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bal.plot</span>(school_nearest, <span class="at">var.name =</span> <span class="st">&#39;ENI&#39;</span>, <span class="at">which =</span> <span class="st">&quot;both&quot;</span>)</span></code></pre></div>
<p><img src="bookdownproj_files/figure-html/unnamed-chunk-2-4.png" width="672" />
<span class="math display">\[
\begin{align}
ELA_scores = \beta_0 +\beta_1GTOption + \epsilon
\end{align}
\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="part-3-causal-inference.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-2"><a href="part-3-causal-inference.html#cb7-2" aria-hidden="true" tabindex="-1"></a> nearest_matched <span class="ot">&lt;-</span> <span class="fu">match.data</span>(school_nearest)</span>
<span id="cb7-3"><a href="part-3-causal-inference.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb7-4"><a href="part-3-causal-inference.html#cb7-4" aria-hidden="true" tabindex="-1"></a>model_n <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="st">`</span><span class="at">3 2019.math</span><span class="st">`</span> <span class="sc">~</span> treatment, <span class="at">data =</span> nearest_matched)</span>
<span id="cb7-5"><a href="part-3-causal-inference.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model_n)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = `3 2019.math` ~ treatment, data = nearest_matched)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -29.5541  -6.5541  -0.3061   6.4459  30.4459 
## 
## Coefficients:
##             Estimate Std. Error  t value Pr(&gt;|t|)    
## (Intercept) 602.5541     0.5182 1162.788   &lt;2e-16 ***
## treatment     4.7520     1.0625    4.472    1e-05 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 9.182 on 410 degrees of freedom
##   (145 observations deleted due to missingness)
## Multiple R-squared:  0.04652,    Adjusted R-squared:  0.04419 
## F-statistic:    20 on 1 and 410 DF,  p-value: 1.003e-05</code></pre>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-2-descriptive-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-3-geospatial-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/edit/master/05-causal_analysis.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/YOUR GITHUB USERNAME/YOUR REPO NAME/blob/master/05-causal_analysis.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
